<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="Example Application with Mezzio: Testing">
<meta itemprop="description" content="Where do we start? I think it&rsquo;s a good exercise to start any application with a solid structure for testing the application with automated testing tools. That&rsquo;s why the first post in this series is about testing.
In this post, I&rsquo;ll show a basic setup for testing Mezzio applications. We&rsquo;ll get to some more advanced testing topics in later posts.
Legacy ZF Testing Tools Those experienced with Zend Framework MVC applications are likely familiar with the zend-test library for ZF3, or Zend\Test for ZF2 and maybe even Zend_Test, the old ZF1 testing framework.">


<meta itemprop="datePublished" content="2019-12-01T14:28:49-05:00" />
<meta itemprop="dateModified" content="2019-12-04T11:01:44-05:00" />
<meta itemprop="wordCount" content="820">



<meta itemprop="keywords" content="php,mezzio,laminas,prophecy,phpunit," />
<meta property="og:title" content="Example Application with Mezzio: Testing" />
<meta property="og:description" content="Where do we start? I think it&rsquo;s a good exercise to start any application with a solid structure for testing the application with automated testing tools. That&rsquo;s why the first post in this series is about testing.
In this post, I&rsquo;ll show a basic setup for testing Mezzio applications. We&rsquo;ll get to some more advanced testing topics in later posts.
Legacy ZF Testing Tools Those experienced with Zend Framework MVC applications are likely familiar with the zend-test library for ZF3, or Zend\Test for ZF2 and maybe even Zend_Test, the old ZF1 testing framework." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//marc.guyer.me/posts/example-application-with-mezzio-testing/" />
<meta property="article:published_time" content="2019-12-01T14:28:49-05:00" />
<meta property="article:modified_time" content="2019-12-04T11:01:44-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Example Application with Mezzio: Testing"/>
<meta name="twitter:description" content="Where do we start? I think it&rsquo;s a good exercise to start any application with a solid structure for testing the application with automated testing tools. That&rsquo;s why the first post in this series is about testing.
In this post, I&rsquo;ll show a basic setup for testing Mezzio applications. We&rsquo;ll get to some more advanced testing topics in later posts.
Legacy ZF Testing Tools Those experienced with Zend Framework MVC applications are likely familiar with the zend-test library for ZF3, or Zend\Test for ZF2 and maybe even Zend_Test, the old ZF1 testing framework."/>

	<link rel="apple-touch-icon" sizes="180x180" href="//www.gravatar.com/avatar/65a09071cad77a42b1421c8119352229?s=180">
	<link rel="icon" type="image/png" sizes="32x32" href="//www.gravatar.com/avatar/65a09071cad77a42b1421c8119352229?s=32">
	<link rel="icon" type="image/png" sizes="16x16" href="//www.gravatar.com/avatar/65a09071cad77a42b1421c8119352229?s=16">
	<link rel="shortcut icon" href="//www.gravatar.com/avatar/65a09071cad77a42b1421c8119352229?s=512">
	

	<title>Example Application with Mezzio: Testing</title>
	<link rel="stylesheet" href="//marc.guyer.me/css/style.min.568c54a56780af2a70c45272522247710b69dbfc080b315211fb98381e3796f8.css" integrity="sha256-VoxUpWeArypwxFJyUiJHcQtp2/wICzFSEfuYOB43lvg=">
	
	<link rel="stylesheet" href="//marc.guyer.me/css/home.css">
	<link rel="stylesheet" href="//marc.guyer.me/css/avatar.css">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="//marc.guyer.me">Marc Guyer</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="//marc.guyer.me/posts/">Posts</a>
				<a href="//marc.guyer.me/about/">About</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://github.com/marcguyer" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://stackoverflow.com/users/1774759/marcguyer" target="_blank" rel="noopener me" title="Stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.913 16.041v6.848h17.599v-6.848M7.16 18.696h8.925M7.65 13.937l8.675 1.8M9.214 9.124l8.058 3.758M12.086 4.65l6.849 5.66M15.774 1.111l5.313 7.162"/></svg></a><a href="https://instagram.com/marcguyer" target="_blank" rel="noopener me" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="//marc.guyer.me/posts/">Posts</a></li>
			<li><a href="//marc.guyer.me/about/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>2019-12-01</span></div>
				<h1>Example Application with Mezzio: Testing</h1>
			</header>
			<div class="content">
				

<h2 id="where-do-we-start">Where do we start?<a href="#where-do-we-start" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>

<p>I think it&rsquo;s a good exercise to start any application with a solid structure for testing the application with automated testing tools. That&rsquo;s why the first post in this series is about testing.</p>

<p>In this post, I&rsquo;ll show a basic setup for testing Mezzio applications. We&rsquo;ll get to some more advanced testing topics in later posts.</p>

<h2 id="legacy-zf-testing-tools">Legacy ZF Testing Tools<a href="#legacy-zf-testing-tools" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>

<p>Those experienced with <a href="https://docs.zendframework.com/zend-mvc/">Zend Framework MVC</a> applications are likely familiar with the <a href="https://docs.zendframework.com/zend-test/">zend-test</a> library for ZF3, or <a href="https://framework.zend.com/manual/2.4/en/modules/zend.test.introduction.html">Zend\Test</a> for ZF2 and maybe even <a href="https://framework.zend.com/manual/1.12/en/zend.test.introduction.html">Zend_Test</a>, the old ZF1 testing framework.</p>

<p>The documentation for these components allude to <em>unit testing</em> your application using these tools. That, unfortunately is a misnomer. All of the testing libraries provided by Zend Framework support <em>integration testing</em> or <em>functional testing</em> your code, but certainly not <em>unit testing</em>. The difference between unit tests and integration tests is dramatic. Those differences have been blogged about at length. Check the goog for more information about the different types of tests.</p>

<h2 id="a-basic-example">A Basic Example<a href="#a-basic-example" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>

<p>Let&rsquo;s start with an example functional test of your new complete Mezzio application middleware stack. This example should be somewhat familiar if you&rsquo;re used to how <a href="https://docs.zendframework.com/zend-test/">zend-test</a> works with old MVC apps. We&rsquo;ll test the ping route that comes with the <a href="https://github.com/zendframework/zend-expressive-skeleton">Mezzio Skeleton Application</a>.</p>

<p>You may have noticed that skeleton comes with some basic tests of the simple handlers that come with the skeleton. We&rsquo;ll show those in a later post. For now, we&rsquo;re going to start with a functional test of the <code>GET /api/ping</code> REST endpoint from end to end. This test will exercise the entire stack so we can prove that the endpoint &ldquo;works&rdquo;.</p>

<p>I&rsquo;ve created a couple of simple abstract classes that all of my functional tests can extend, making writing new tests fast and easy. These tests use real instances of your application components &ndash; the dependency injection container and the application itself including the middleware pipeline and the routes. In fact the base class might remind you of an application bootstrap like that found in <code>public/index.php</code> in a Mezzio skeleton app.</p>

<p>Here&rsquo;s the base class for all functional tests. You&rsquo;ll note that this does nothing except initialize the application to be tested. Some assumptions must hold true for this to work out of the box. In short, if you start with the Mezzio skeleton, you should be all set. If the paths to your container/pipeline/routes config is non-standard, you might have to do some extra work &ndash; perhaps a symlink or two.</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="k">namespace</span> <span class="nx">FunctionalTest</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Psr\Container\ContainerInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Expressive\Application</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Expressive\MiddlewareFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Helmich\Psr7Assert\Psr7Assertions</span><span class="p">;</span>

<span class="sd">/**
</span><span class="sd"> * {@inheritdoc}
</span><span class="sd"> */</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractFunctionalTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">Psr7Assertions</span><span class="p">;</span>

    <span class="sd">/** @var ContainerInterface */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="nv">$container</span><span class="p">;</span>

    <span class="sd">/** @var Application */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="nv">$app</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">setUpBeforeClass</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">static</span><span class="o">::</span><span class="na">initContainer</span><span class="p">();</span>
        <span class="k">static</span><span class="o">::</span><span class="na">initApp</span><span class="p">();</span>
        <span class="k">static</span><span class="o">::</span><span class="na">initPipeline</span><span class="p">();</span>
        <span class="k">static</span><span class="o">::</span><span class="na">initRoutes</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">tearDownAfterClass</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">static</span><span class="o">::</span><span class="nv">$container</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="k">static</span><span class="o">::</span><span class="nv">$app</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * Initialize new container instance.
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">initContainer</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">static</span><span class="o">::</span><span class="nv">$container</span> <span class="o">=</span> <span class="k">require</span> <span class="s1">&#39;config/container.php&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * Initialize app.
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">initApp</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">static</span><span class="o">::</span><span class="nv">$app</span> <span class="o">=</span> <span class="k">static</span><span class="o">::</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">Application</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * Initialize pipeline.
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">initPipeline</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="p">(</span><span class="k">require</span> <span class="s1">&#39;config/pipeline.php&#39;</span><span class="p">)(</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$app</span><span class="p">,</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">MiddlewareFactory</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$container</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * Initialize routes.
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">initRoutes</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="p">(</span><span class="k">require</span> <span class="s1">&#39;config/routes.php&#39;</span><span class="p">)(</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$app</span><span class="p">,</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">MiddlewareFactory</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
            <span class="k">static</span><span class="o">::</span><span class="nv">$container</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Any simple tests that require only a minimally bootstrapped application can extend the <code>AbstractFunctionalTest</code> class and test away.</p>

<p>Now it gets a little bit more interesting. Here&rsquo;s an abstract extension that adds some framework for defining REST endpoints to be tested and assertions for testing those endpoints:</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="k">namespace</span> <span class="nx">FunctionalTest</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Psr\Http\Message\ResponseInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Psr\Http\Message\ServerRequestInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Diactoros\Stream</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Diactoros\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Diactoros\Response</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Diactoros\ServerRequest</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Zend\Diactoros\Uri</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PHPUnit\Framework\Constraint</span><span class="p">;</span>

<span class="sd">/**
</span><span class="sd"> * Abstract to set up functional testing via endpoint provider config.
</span><span class="sd"> */</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractFunctionalEndpointTest</span> <span class="k">extends</span> <span class="nx">AbstractFunctionalTest</span>
<span class="p">{</span>
    <span class="sd">/**
</span><span class="sd">     * Provider for testEndpoint() method.
</span><span class="sd">     *
</span><span class="sd">     * @see self::testEndpoint() for provider signature
</span><span class="sd">     *
</span><span class="sd">     * @return array
</span><span class="sd">     */</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">endpointProvider</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span><span class="p">;</span>

    <span class="sd">/**
</span><span class="sd">     * @param string $method
</span><span class="sd">     * @param string $uri
</span><span class="sd">     * @param array  $requestHeaders
</span><span class="sd">     * @param array  $body
</span><span class="sd">     * @param array  $queryParams
</span><span class="sd">     *
</span><span class="sd">     * @return ServerRequestInterface
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">getRequest</span><span class="p">(</span>
        <span class="nx">string</span> <span class="nv">$method</span><span class="p">,</span>
        <span class="nx">string</span> <span class="nv">$uri</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$requestHeaders</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="k">array</span> <span class="nv">$body</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="k">array</span> <span class="nv">$queryParams</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">ServerRequestInterface</span> <span class="p">{</span>
        <span class="nv">$uri</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Uri</span><span class="p">(</span><span class="nv">$uri</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$body</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$bodyStream</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s1">&#39;php://memory&#39;</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">);</span>
            <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$bodyStream</span><span class="p">,</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$body</span><span class="p">));</span>
            <span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Stream</span><span class="p">(</span><span class="nv">$bodyStream</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$queryParams</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$uri</span> <span class="o">=</span> <span class="nv">$uri</span><span class="o">-&gt;</span><span class="na">withQuery</span><span class="p">(</span><span class="nx">http_build_query</span><span class="p">(</span><span class="nv">$queryParams</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nx">ServerRequest</span><span class="p">(</span>
            <span class="p">[],</span>
            <span class="p">[],</span>
            <span class="nv">$uri</span><span class="p">,</span>
            <span class="nv">$method</span><span class="p">,</span>
            <span class="nv">$body</span> <span class="o">??</span> <span class="s1">&#39;php://input&#39;</span><span class="p">,</span>
            <span class="nv">$requestHeaders</span> <span class="o">??</span> <span class="p">[]</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * @dataProvider endpointProvider
</span><span class="sd">     *
</span><span class="sd">     * @param ServerRequestInterface $request
</span><span class="sd">     * @param Constraint[] $responseConstraints
</span><span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testEndpoint</span><span class="p">(</span>
        <span class="nx">ServerRequestInterface</span> <span class="nv">$request</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$responseConstraints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="k">static</span><span class="o">::</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertInstanceOf</span><span class="p">(</span><span class="nx">ResponseInterface</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertResponseConstraints</span><span class="p">(</span><span class="nv">$responseConstraints</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**
</span><span class="sd">     * @param Constraint[]      $responseConstraints
</span><span class="sd">     * @param ResponseInterface $response
</span><span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">assertResponseConstraints</span><span class="p">(</span>
        <span class="k">array</span> <span class="nv">$responseConstraints</span><span class="p">,</span>
        <span class="nx">ResponseInterface</span> <span class="nv">$response</span>
    <span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$responseConstraints</span> <span class="k">as</span> <span class="nv">$msg</span> <span class="o">=&gt;</span> <span class="nv">$constraint</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertThat</span><span class="p">(</span>
                <span class="nv">$response</span><span class="p">,</span>
                <span class="nv">$constraint</span><span class="p">,</span>
                <span class="nx">is_string</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$msg</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="//marc.guyer.me/tags/php">php</a></span><span class="tag"><a href="//marc.guyer.me/tags/mezzio">mezzio</a></span><span class="tag"><a href="//marc.guyer.me/tags/laminas">laminas</a></span><span class="tag"><a href="//marc.guyer.me/tags/prophecy">prophecy</a></span><span class="tag"><a href="//marc.guyer.me/tags/phpunit">phpunit</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>820 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-12-01 19:28 &#43;0000</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/marcguyer/marcguyer.github.io/commit/59a525601f9c6f6a7449354d29d5c9657e5ea91d" target="_blank" rel="noopener">59a5256</a> @ 2019-12-04</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="prev-post" href="//marc.guyer.me/posts/example-application-with-mezzio-introduction/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Example Application with Mezzio: Introduction</span>
			</a>
		</div>
		<div id="comments" class="thin">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "marcguyer" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="//marc.guyer.me">Marc Guyer</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a>
		</p>
	</footer>


	<script src="//marc.guyer.me/js/main.min.35ccbf1cdceb91e4c64c06b5d009d6e2977fafe56beda7762febd4e67528d2ac.js" integrity="sha256-Ncy/HNzrkeTGTAa10AnW4pd/r+Vr7ad2L+vU5nUo0qw="></script>

</body>

</html>
